\section{Spezialthemen}


\subsection{XXE File Inclusion}
Unter dem Begriff ist eine Attacke über das \textit{XML External Entity Processing} möglich. Dabei können externe Daten, wie z.B. lokale Dateien, in das XML inkludiert werden. Bei der Verarbeitung solcher Inclusions, welche im DTD angegeben sind, fügt sie der Parser in die angegebenen Stelle ein.\\

\textbf{Lösung:} Deaktivierung des Features für DTDs (External Entities) beim Parser.

\begin{lstlisting}[language=XML, caption=Beispiel der XXE]
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [  
<!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&xxe;</foo>
\end{lstlisting}

\subsection{JSON-Hijacking}
JSON-Hijacking wird dazu verwendet, sensitive Daten, die mittels JSON Format an einen authentifizierten Empfänger übermittelt werden, zu stehlen. Dazu muss das Opfer eine verseuchte Webseite laden, die mittels JavaScript einen GET Request zur verwundbaren Webseite sendet. Ausserdem wird in diesem JavaScript die Callback Funktion so überschrieben, dass neu die Response auf diesen GET Request (sensitive JSON Daten) auch an den Hacker übermittelt wird. \\

\textbf{Vorbeugung:}
\begin{easylist}
	& Token in Request URLs verwenden, sodass diese nicht erraten werden können
	& JSON Response mit einem Infinite Loop beginnen
	& JSONP vermeiden
\end{easylist} 

\subsection{URL-Redirection}
URL-Redirection wird häufig im Zusammenhang mit Phishing verwendet, mit dem Ziel, eine Session übernehmen zu können. Dazu wird dem Opfer einen Link untergeschoben, der auf den ersten Blick vertrauenswürdig aussieht. In Wirklichkeit enthält dieser jedoch einen Redirect auf eine Landing-Page des Hackers. Klickt das Opfer auf diesen Link, so wird normal das Login-Formular der vertrauenswürdigen Webseite geladen. Gibt das Opfer nun seine Credentials ein, werden diese auf Korrektheit geprüft und es wird eine Session ausgestellt. Nach dem erfolgreichen Login, wird nun durch Redirection nicht die vertrauenswürdige Webseite geladen, sondern die Landing-Page des Hackers. Dadurch sieht der Hacker im Log seiner Page die ausgestellte Session und kann diese übernehmen. Das Opfer selbst erhält nur eine Meldung, dass die gewünschte Seite nicht erreichbar ist. \\

Beispiel: http://www.example.com/login?redirect=http://www.examp1e.com \\

\textbf{Vorbeugung:}
\begin{easylist}
	& Inputvalidierung
	&& Parameter die Redirect URLS enthalten validieren
	&& Prüfen ob URL wirklich zur Seite gehört
	& Lookup Tables
	&& Erstellen von Mappings zwischen Parameter und URL
	&& redirect=1
	&& redirect=acc
\end{easylist} 

\todo[inline]{SSL/TLS: SSL-Cipher-Suite-Hardening, SSL-MitM}
\todo[inline]{HTTP Request Smuggling}
\todo[inline]{Session fixation, an sich bei Basics bereits erläutert, Ausführung möglich}